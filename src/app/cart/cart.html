<div class="container mt-4">
  <h2 class="mb-4">ðŸ›’ Your Cart</h2>

  @if ((cartItems$ | async)?.length === 0) {
    <p>Your cart is empty.</p>
  }

  @if ((cartItems$ | async)?.length) {
    <div class="list-group mb-3">
      @for (item of cartItems$ | async; track item.pizzaId) {
        <div class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <h6 class="mb-1">{{ item.name }}</h6>

            @if (item.toppings?.length) {
              <small class="text-muted">
                {{ item.toppings.join(', ') }}
              </small>
            }
          </div>

          <div class="d-flex align-items-center gap-2">
            <button class="btn btn-sm btn-outline-secondary" (click)="decrement(item)">âˆ’</button>

            <span>{{ item.quantity }}</span>

            <button class="btn btn-sm btn-outline-secondary" (click)="increase(item)">+</button>

            <span class="fw-bold ms-3"> â‚¬ {{ item.price * item.quantity | number: '1.2-2' }} </span>

            <button class="btn btn-sm btn-outline-danger ms-2" (click)="remove(item)">âœ•</button>
          </div>
        </div>
      }
    </div>

    <div class="d-flex justify-content-between align-items-center">
      <strong>Total:</strong>
      <strong>â‚¬ {{ getTotal() | number: '1.2-2' }}</strong>
    </div>

    <div *ngIf="errorMessages.length" class="alert alert-danger">
      <ul>
        <li *ngFor="let msg of errorMessages">{{ msg }}</li>
      </ul>
    </div>

    <label for="email" class="mt-3">Email:</label>
    <input
      type="email"
      id="email"
      [(ngModel)]="email"
      class="form-control"
      placeholder="Enter your email"
      required
    />

    <label for="pickup">Pickup Time:</label>
    <input type="datetime-local" id="pickup" [(ngModel)]="pickupTime" />

    <div class="mt-3 text-end">
      <button class="btn btn-danger me-2" (click)="clear()">Clear</button>
      <button
        class="btn btn-success w-100 mt-3"
        (click)="placeOrder()"
        [disabled]="(cartItems$ | async)?.length === 0"
      >
        Place Order
      </button>
    </div>
  }
</div>
